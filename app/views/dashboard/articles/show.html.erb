<div class="px-4 pt-4 mb-4 flex items-center space-x-4">
  <%= link_to t('articles_manage'), dashboard_articles_path, class: "min-w-fit" %>
  <span>/</span>
  <span class="font-bold truncate"><%= @article.title %></span>
</div>

<div class="px-4 mb-4 flex items-center justify-end space-x-4">
  <%= link_to t('edit'), edit_article_path(@article.uuid), class: "rounded bg-blue-500 hover:bg-blue-600 text-white px-4 py-1" %>
</div>

<div class="px-4 mb-4">
  <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.created_at') %>
      </div>
      <div class="font-bold">
        <%= @article.created_at.strftime("%Y-%m-%d %H:%M") %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.updated_at') %>
      </div>
      <div class="font-bold">
        <%= @article.updated_at.strftime("%Y-%m-%d %H:%M") %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.price') %>
      </div>
      <div class="font-bold">
        <%= @article.price %>
        <%= @article.currency.symbol %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.price') %>(USD)
      </div>
      <div class="font-bold">
        $<%= @article.price_usd %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.unpaid_views_count') %>
      </div>
      <div class="font-bold">
        <%= @article.impressionist_count(message: 'partial') %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.paid_views_count') %>
      </div>
      <div class="font-bold">
        <%= @article.impressionist_count(message: 'full') %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.shares_count') %>
      </div>
      <div class="font-bold">
        <%= @article.impressionist_count(message: 'share') %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.pre_orders_count') %>
      </div>
      <div class="font-bold">
        <%= @article.pre_orders.count %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.buy_orders_count') %>
      </div>
      <div class="font-bold">
        <%= @article.buy_orders.count %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.reward_orders_count') %>
      </div>
      <div class="font-bold">
        <%= @article.reward_orders.count %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.comments_count') %>
      </div>
      <div class="font-bold">
        <%= @article.comments.count %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.upvotes_count') %>
      </div>
      <div class="font-bold">
        <%= @article.upvotes_count %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.downvotes_count') %>
      </div>
      <div class="font-bold">
        <%= @article.downvotes_count %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.revenue') %>
      </div>
      <div class="font-bold">
        $<%= @article.revenue_usd.round(4) %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.author_revenue_total') %>
      </div>
      <div class="font-bold">
        $<%= @article.author_revenue_usd.round(4) %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.reader_revenue_total') %>
      </div>
      <div class="font-bold">
        $<%= @article.reader_revenue_usd.round(4) %>
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('readers_revenue') %>
      </div>
      <div class="font-bold">
        <%= @article.readers_revenue_ratio * 100 %>%
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('collection_revenue') %>
      </div>
      <div class="font-bold">
        <%= @article.collection_revenue_ratio * 100 %>%
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('references_revenue') %>
      </div>
      <div class="font-bold">
        <%= @article.references_revenue_ratio * 100 %>%
      </div>
    </div>
    <div class="text-center p-2">
      <div class="text-sm opacity-75">
        <%= t('author_revenue') %>
      </div>
      <div class="font-bold">
        <%= @article.author_revenue_ratio * 100 %>%
      </div>
    </div>
    <div class="text-center p-2 col-span-2">
      <div class="text-sm opacity-75">
        <%= t('activerecord.attributes.article.tags') %>
      </div>
      <div class="font-bold flex items-center flex-wrap justify-center space-x-2">
        <% if @article.tag_names.blank? %>
          -
        <% else %>
          <% @article.tag_names.each do |tag_name| %>
            <div class="p-1 bg-zinc-100 text-sm">#<%= tag_name %></div>
          <% end %>
        <% end %>
      </div>
    </div>
    <div class="text-center p-2 col-span-2">
      <div class="text-sm opacity-75">
        <%= t('article_references') %>
      </div>
      <div class="font-bold">
        <% if @article.references.blank? %>
          -
        <% else %>
          <% @article.references.each do |reference| %>
            <%= link_to reference.title, user_article_path(reference.author, reference.uuid), class: "mb-2 text-sm" %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="mb-4"
  data-controller="tabs"
  data-tabs-active-tab-value="<%= @tab %>"
  data-tabs-active-class-value="border-b-2">
  <div class="w-full flex overflow-auto flex-nowrap scrollbar-hide items-center flex px-4 mb-4">
    <%= link_to t('buy_records'), 
      dashboard_article_path(@article, tab: :buy_records),
      class: "cursor-pointer py-1 px-2 border-blue-500 opacity-75 min-w-fit",
      data: {
        tabs_target: "tab",
        tabs_tabname_param: "buy_records",
        action: "tabs#active"
      } %>
    <%= link_to t('reward_records'), 
      dashboard_article_path(@article, tab: :reward_records),
      class: "cursor-pointer py-1 px-2 border-blue-500 opacity-75 min-w-fit",
      data: {
        tabs_target: "tab",
        tabs_tabname_param: "reward_records",
        action: "tabs#active"
      } %>
    <%= link_to t('cite_records'), 
      dashboard_article_path(@article, tab: :cite_records),
      class: "cursor-pointer py-1 px-2 border-blue-500 opacity-75 min-w-fit",
      data: {
        tabs_target: "tab",
        tabs_tabname_param: "cite_records",
        action: "tabs#active"
      } %>
    <%= link_to t('comment_records'), 
      dashboard_article_path(@article, tab: :comment_records),
      class: "cursor-pointer py-1 px-2 border-blue-500 opacity-75 min-w-fit",
      data: {
        tabs_target: "tab",
        tabs_tabname_param: "comment_records",
        action: "tabs#active"
      } %>
  </div>
  <div class="hidden pb-4"
    data-tabs-content-param="buy_records"
    data-tabs-target="content">
    <%= turbo_frame_tag "#{dom_id @article}_orders", src: dashboard_orders_path(article_uuid: @article.uuid, order_type: :buy_article), loading: :lazy do %>
      <%= render "shared/loading" %>
    <% end %>
  </div>
  <div class="hidden pb-4"
    data-tabs-content-param="reward_records"
    data-tabs-target="content">
    <%= turbo_frame_tag "#{dom_id @article}_orders", src: dashboard_orders_path(article_uuid: @article.uuid, order_type: :reward_article), loading: :lazy do %>
      <%= render "shared/loading" %>
    <% end %>
  </div>
  <div class="hidden pb-4"
    data-tabs-content-param="cite_records"
    data-tabs-target="content">
    <%= turbo_frame_tag "#{dom_id @article}_orders", src: dashboard_orders_path(article_uuid: @article.uuid, order_type: :cite_article), loading: :lazy do %>
      <%= render "shared/loading" %>
    <% end %>
  </div>
  <div class="hidden pb-4"
    data-tabs-content-param="comment_records"
    data-tabs-target="content">
    <%= turbo_frame_tag "#{dom_id @article}_comments", src: dashboard_comments_path(article_uuid: @article.uuid), loading: :lazy do %>
      <%= render "shared/loading" %>
    <% end %>
  </div>
</div>
