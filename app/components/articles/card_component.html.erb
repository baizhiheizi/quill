<div class="pt-8 pb-4 border-b">
  <div class="flex items-center justify-between mb-4">
    <div class="flex items-center space-x-2">
      <%= image_tag @article.author.avatar, class: 'w-7 h-7 rounded-full' %>
      <span class="text-sm">
        <%= @article.author.short_name %>
      </span>
      <span class="text-sm opacity-60">
        <%= render TimeFormatComponent.new datetime: @article.published_at.rfc3339 do %>
          <%= @article.published_at.strftime("%Y-%m-%d %H:%M") %>
        <% end %>
      </span>
    </div>
    <div class="flex items-center space-x-2">
      <% if @article.free? %>
        <div class="text-sm px-2 bg-green-500 text-white rounded">
          FREE
        </div>
      <% else %>
        <span class="text-sm">
          <%= @article.price_tag %>
        </span>
        <span class="text-sm opacity-60">
          â‰ˆ$<%= @article.price_usd %>
        </span>
        <%= image_tag @article.currency.icon_url, class: "w-6 h-6 rounded-full" %>
      <% end %>
    </div>
  </div>

  <%= link_to user_article_path(@article.author, @article),
    data: {
      controller: "prefetch",
      turbo_frame: "_top"
    },
    class: "flex items-start max-h-28 space-x-4 mb-6" do %>
    <div class="flex-1 h-full">
      <div class="truncate font-bold text-xl mb-3">
        <%= @article.title %>
      </div>
      <div class="text-base break-words text-ellipsis overflow-hidden line-clamp-3 text-[#222222] text-opacity-80"> <%= @article.intro %>
      </div>
    </div>
    <% if @article.cover_url.present? %>
      <%= image_tag @article.cover_url, class: "w-28 h-28 rounded object-center" %>
    <% end %>
  <% end %>

  <div class="flex items-center justify-between">
    <div class="flex-1 flex overflow-x-scroll scrollbar-hide items-center space-x-4">
      <% @article.tags.each do |tag| %>
        <%= link_to articles_path(tag: tag.name), 
          data: { 
            controller: 'prefetch',
          turbo_frame: "_top"
          }, 
          class: "px-2 py-1 text-sm min-w-max rounded", 
          style: "word-break:keep-all;color:#{tag.color};background-color:#{tag.bg_color};" do %>
          <%= tag.name %>
        <% end %>
      <% end %>
    </div>
    <div class="flex items-center space-x-4 ml-4 text-[#B1B6C6]">
      <div class="flex items-center space-x-1">
        <%= inline_svg_tag 'icons/income-solid.svg', class: 'w-4 h-4' %>
        <span class="text-sm">
          <%= @article.revenue_usd.round(4) %>
        </span>
      </div>
      <div class="flex items-center space-x-1">
        <%= inline_svg_tag 'icons/comment-solid.svg', class: 'w-4 h-4' %>
        <span class="text-sm">
          <%= @article.comments_count %>
        </span>
      </div>
      <% if @article.upvote_ratio.present? %>
        <div class="flex items-center space-x-1">
          <%= inline_svg_tag 'icons/like-solid.svg', class: 'w-4 h-4' %>
          <span class="text-sm">
            <%= @article.upvote_ratio %>
          </span>
        </div>
      <% end %>
      <%= link_to article_share_path(article_uuid: @article.uuid), 
        data: {
          turbo_frame: :modal
        },
        class: "flex items-center space-x-1" do %>
        <%= inline_svg_tag 'icons/share-solid.svg', class: 'w-4 h-4' %>
      <% end %>
    </div>
  </div>
</div>
