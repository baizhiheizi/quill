#!/usr/bin/env bash

# throw error when failed
set -e

# use cn credentials
cp config/credentials/cn.yml.enc config/credentials.yml.enc
cp config/settings.cn.example.yml config/settings.yml

yarn install
bundle install

# compile assets
yarn build
yarn build:css
bundle exec bin/rails assets:precompile

# clean assets
bundle exec bin/rails assets:clean

# prepare DB
bin/rails db:prepare
